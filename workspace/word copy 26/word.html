<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡ç‰‡é¡¶éƒ¨2/3ä½ç½®+æ»‘åŠ¨æ•ˆæœï¼ˆç»ˆæä¿®å¤ç‰ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: sans-serif;
        }

        body {
            padding: 20px;
            background-color: #f5f7fa;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 20px;
            height: calc(100vh - 40px);
        }

        .column {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .column-header {
            padding: 16px;
            background-color: #4299e1;
            color: white;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .count-badge {
            background-color: rgba(255,255,255,0.3);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 14px;
        }

        .column-content {
            padding: 16px;
            overflow-y: auto;
            height: calc(100% - 50px);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* å¡ç‰‡æ ·å¼ + æ ¸å¿ƒåŠ¨ç”» */
        .word-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            font-size: 18px;
            color: #2d3748;
            cursor: default;
            width: 100%;
            max-width: 500px;
            opacity: 1;
        }

        .word-card.active {
            border: 2px solid #4299e1;
            box-shadow: 0 0 0 2px rgba(66,153,225,0.2), 0 4px 12px rgba(0,0,0,0.1);
            background-color: #f8fafe;
        }

        /* æ»‘å‡ºåŠ¨ç”» */
        .card-slide-out-left {
            transform: translateX(-120%) scale(0.9);
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .card-slide-out-right {
            transform: translateX(120%) scale(0.9);
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* æ»‘å…¥åŠ¨ç”» */
        .card-slide-in-up {
            animation: slideInUp 0.4s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100px) scale(0.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        /* ç©ºçŠ¶æ€/åŠ è½½çŠ¶æ€ */
        .empty-state, .loading-state {
            text-align: center;
            padding: 80px 20px;
            color: #999;
            font-size: 16px;
            line-height: 1.8;
            width: 100%;
            max-width: 500px;
        }

        .loading-state {
            color: #666;
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
                height: auto;
            }

            .column {
                height: 500px;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å·¦åˆ—ï¼šå·²ç‰¢è®° -->
        <div class="column">
            <div class="column-header">
                <span>å·²ç‰¢è®°</span>
                <span id="masteredCount" class="count-badge">0</span>
            </div>
            <div id="masteredList" class="column-content">
                <div class="empty-state">æš‚æ— å•è¯<br>æŒ‰â†é”®å°†ä¸­é—´å•è¯ç§»è‡³æ­¤å¤„</div>
            </div>
        </div>

        <!-- ä¸­åˆ—ï¼šå¾…å·©å›ºï¼ˆæ ¸å¿ƒæ¼”ç¤ºåŒºï¼‰ -->
        <div class="column">
            <div class="column-header">
                <span>å¾…å·©å›ºï¼ˆå¡ç‰‡é¡¶éƒ¨å¯¹é½2/3ä½ç½®ï¼‰</span>
                <span id="reviewCount" class="count-badge">0</span>
            </div>
            <div id="reviewContent" class="column-content">
                <div id="wordList" class="loading-state">åŠ è½½ä¸­... è¯·ç¨å€™</div>
            </div>
        </div>

        <!-- å³åˆ—ï¼šå¾…è®°å¿† -->
        <div class="column">
            <div class="column-header">
                <span>å¾…è®°å¿†</span>
                <span id="untrainedCount" class="count-badge">0</span>
            </div>
            <div id="untrainedList" class="column-content">
                <div class="empty-state">æš‚æ— å•è¯<br>æŒ‰â†’é”®å°†ä¸­é—´å•è¯ç§»è‡³æ­¤å¤„</div>
            </div>
        </div>
    </div>

    <script>
        // æ ¸å¿ƒå˜é‡
        let currentIndex = 0;
        let isAnimating = false;
        let allWords = [];
        let remainingWords = [];

        // DOM å…ƒç´ 
        const wordListEl = document.getElementById('wordList');
        const reviewContent = document.getElementById('reviewContent');
        const masteredList = document.getElementById('masteredList');
        const untrainedList = document.getElementById('untrainedList');
        const reviewCountEl = document.getElementById('reviewCount');
        const masteredCountEl = document.getElementById('masteredCount');
        const untrainedCountEl = document.getElementById('untrainedCount');

        // åˆå§‹åŒ–
        async function init() {
            try {
                const response = await fetch('Vocabulary.json');
                if (!response.ok) throw new Error('æ–‡ä»¶åŠ è½½å¤±è´¥');
                allWords = await response.json();
                remainingWords = [...allWords];
                renderWordList();
                updateCounts();
                bindKeyboardEvents();
                setTimeout(() => {
                    if (remainingWords.length > 0) {
                        updateActiveCard();
                        centerActiveCard(false);
                    }
                }, 100);
            } catch (error) {
                wordListEl.innerHTML = `<div class="empty-state">âŒ åŠ è½½å¤±è´¥<br>è¯·æ£€æŸ¥ Vocabulary.json æ˜¯å¦å­˜åœ¨</div>`;
                console.error('åŠ è½½é”™è¯¯ï¼š', error);
            }
        }

        // æ¸²æŸ“å•è¯åˆ—è¡¨ï¼ˆä»…æ ¹æ®remainingWordså’ŒcurrentIndexæ¸²æŸ“ï¼Œä¸ç»‘å®šé¢å¤–ç´¢å¼•ï¼‰
        function renderWordList() {
            if (remainingWords.length === 0) {
                wordListEl.innerHTML = '<div class="empty-state">ğŸ‰ æ‰€æœ‰å•è¯å·²åˆ†ç±»å®Œæˆï¼</div>';
                return;
            }

            let html = '';
            remainingWords.forEach((wordObj, index) => {
                const word = wordObj.word || 'æ— å•è¯';
                html += `<div class="word-card ${index === currentIndex ? 'active' : ''}">${word}</div>`;
            });
            wordListEl.innerHTML = html;
        }

        // æ›´æ–°è®¡æ•°
        function updateCounts() {
            reviewCountEl.textContent = remainingWords.length;
            masteredCountEl.textContent = document.querySelectorAll('#masteredList .word-card').length;
            untrainedCountEl.textContent = document.querySelectorAll('#untrainedList .word-card').length;
        }

        // ç»‘å®šé”®ç›˜äº‹ä»¶
        function bindKeyboardEvents() {
            document.addEventListener('keydown', (e) => {
                if (isAnimating || remainingWords.length === 0) return;

                switch (e.key) {
                    case 'ArrowLeft':
                        e.preventDefault();
                        slideAndMoveCard('left', masteredList);
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        slideAndMoveCard('right', untrainedList);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        if (currentIndex > 0) {
                            currentIndex--;
                            updateActiveCard();
                            centerActiveCard(true);
                        }
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        if (currentIndex < remainingWords.length - 1) {
                            currentIndex++;
                            updateActiveCard();
                            centerActiveCard(true);
                        }
                        break;
                }
            });
        }

        // ç»ˆæä¿®å¤ï¼šæ»‘åŠ¨+ç§»åŠ¨é€»è¾‘ï¼ˆç›´æ¥æ“ä½œcurrentIndexå¯¹åº”çš„å¡ç‰‡ï¼Œä¸ä¾èµ–é¢å¤–ç´¢å¼•ï¼‰
        function slideAndMoveCard(direction, targetList) {
            isAnimating = true;
            const oldIndex = currentIndex;
            const currentWordObj = remainingWords[oldIndex];
            // ç›´æ¥è·å–å½“å‰é«˜äº®çš„å¡ç‰‡ï¼ˆæ— éœ€data-indexï¼Œç²¾å‡†å¯¹åº”currentIndexï¼‰
            const currentCard = document.querySelector('.word-card.active');

            // 1. æ—§å¡ç‰‡æ»‘å‡ºåŠ¨ç”»ï¼ˆå¿…è§¦å‘ï¼‰
            currentCard.classList.add(`card-slide-out-${direction}`);

            // 2. è®¡ç®—æ–°ç´¢å¼•ï¼ˆæ»‘åŠ¨åï¼Œä¸‹ä¸€ä¸ªå¡ç‰‡æˆä¸ºé«˜äº®ï¼‰
            let newIndex = oldIndex;
            if (remainingWords.length > 1) {
                // å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå•è¯ï¼Œæ–°ç´¢å¼•=æ—§ç´¢å¼•ï¼ˆä¸‹ä¸€ä¸ªå¡ç‰‡é¡¶ä¸Šæ¥ï¼Œç´¢å¼•ä¸å˜ï¼‰
                // å¦‚æœæ˜¯æœ€åä¸€ä¸ªå•è¯ï¼Œæ–°ç´¢å¼•=æ—§ç´¢å¼•-1ï¼ˆå‰ä¸€ä¸ªå¡ç‰‡æˆä¸ºé«˜äº®ï¼‰
                newIndex = (oldIndex === remainingWords.length - 1) ? oldIndex - 1 : oldIndex;
            }
            currentIndex = newIndex;

            // 3. åŠ¨ç”»ä¸­æœŸï¼ˆ200msï¼‰ï¼šæ›´æ–°æ•°æ®+æ¸²æŸ“æ–°åˆ—è¡¨
            setTimeout(() => {
                // ä»ä¸­é—´åˆ—ç§»é™¤å½“å‰å•è¯ï¼ˆç²¾å‡†åˆ é™¤oldIndexå¯¹åº”çš„å•è¯ï¼‰
                remainingWords.splice(oldIndex, 1);

                // æ·»åŠ åˆ°ç›®æ ‡åˆ—
                const targetCard = document.createElement('div');
                targetCard.className = 'word-card';
                targetCard.textContent = currentWordObj.word || 'æ— å•è¯';
                targetList.appendChild(targetCard);
                targetList.scrollTop = targetList.scrollHeight;

                // é‡æ–°æ¸²æŸ“ä¸­é—´åˆ—
                renderWordList();

                // ç»™æ–°é«˜äº®å¡ç‰‡åŠ æ»‘å…¥åŠ¨ç”»ï¼ˆæ¸²æŸ“åç›´æ¥è·å–activeå¡ç‰‡ï¼‰
                if (remainingWords.length > 0) {
                    const newActiveCard = document.querySelector('.word-card.active');
                    if (newActiveCard) {
                        newActiveCard.classList.add('card-slide-in-up');
                        // æ»‘å…¥åå®šä½åˆ°2/3å¤„
                        setTimeout(() => centerActiveCard(false), 50);
                    }
                }
            }, 200);

            // 4. åŠ¨ç”»ç»“æŸï¼ˆ400msï¼‰ï¼šé‡ç½®çŠ¶æ€
            setTimeout(() => {
                currentCard.classList.remove(`card-slide-out-${direction}`);
                const newActiveCard = document.querySelector('.word-card.active');
                newActiveCard?.classList.remove('card-slide-in-up');
                updateCounts();
                isAnimating = false;
            }, 400);
        }

        // æ›´æ–°é«˜äº®ï¼ˆç¡®ä¿currentIndexå’Œactiveå¡ç‰‡ä¸¥æ ¼å¯¹åº”ï¼‰
        function updateActiveCard() {
            document.querySelectorAll('.word-card').forEach((card, index) => {
                card.classList.toggle('active', index === currentIndex);
            });
        }

        // å¡ç‰‡é¡¶éƒ¨å¯¹é½å®¹å™¨2/3å¤„ï¼ˆå…¬å¼æ­£ç¡®ï¼‰
        function centerActiveCard(useSmooth = false) {
            const activeCard = document.querySelector('.word-card.active');
            if (!activeCard) return;

            const scrollContainer = reviewContent;
            const containerHeight = scrollContainer.clientHeight;
            const cardOffsetTop = activeCard.offsetTop;

            const targetScrollTop = cardOffsetTop - containerHeight * (2/3);
            const finalScrollTop = Math.max(0, targetScrollTop);

            if (useSmooth) {
                scrollContainer.scrollTo({
                    top: finalScrollTop,
                    behavior: 'smooth'
                });
            } else {
                scrollContainer.scrollTop = finalScrollTop;
            }
        }

        // å¯åŠ¨
        init();
    </script>
</body>
</html>